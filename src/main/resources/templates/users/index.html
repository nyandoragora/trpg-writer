<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
    <head>
        <div th:replace="~{fragment :: meta}"></div>

        <div th:replace="~{fragment :: styles}"></div>

        <title>マイページ</title>
    </head>
    <body>
        <div class="trpg-wrapper">
           <div th:replace="~{fragment :: header}"></div>

            <main>
              <!-- ここから本文 -->
              <div class="container py-5">
                <div class="row justify-content-center">
                  <div class="col-lg-8">
                    <div class="card text-center shadow-sm">
                      <div class="card-body p-5">
                        <!-- Profile Image -->
                        <div th:if="${user.imageName}">
                            <img th:src="@{'/storage/user_images/' + ${user.imageName}}" class="rounded-circle mb-4" style="width: 120px; height: 120px; object-fit: cover;" alt="プロフィール画像">
                        </div>
                        <div th:unless="${user.imageName}">
                            <i class="fas fa-user-circle fa-6x mb-4 text-primary"></i>
                        </div>

                        <h1 class="card-title h3 mb-3" th:text="${user.name}"></h1>

                        <!-- Introduction -->
                        <div th:if="${user.introduction}" class="mb-4">
                            <p class="card-text text-muted" style="white-space: pre-wrap;" th:text="${user.introduction}"></p>
                        </div>
                        <div th:unless="${user.introduction}" class="mb-4">
                            <p class="card-text text-muted fst-italic">自己紹介文はまだ登録されていません。</p>
                        </div>

                        <div class="d-grid gap-3">
                          <a th:href="@{/scenarios/my-list}" class="btn btn-primary btn-lg">
                            <i class="fas fa-book-open me-2"></i>作成したシナリオ一覧へ
                          </a>
                          
                          <a th:href="@{/users/my-page/edit}" class="btn btn-outline-secondary">
                            <i class="fas fa-user-edit me-2"></i>プロフィールを編集
                          </a>
                        </div>

                        <hr class="my-4">

                        <div>
                            <form method="post" th:action="@{/users/delete}" onsubmit="return confirm('本当に退会しますか？この操作は取り消すことができません。');">
                                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                                <button type="submit" class="btn btn-link text-danger">アカウントを削除する</button>
                            </form>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </main>

            <div th:replace="~{fragment :: footer}"></div>
        </div>

        <div th:replace="~{fragment :: scripts}"></div>
    </body>
</html>